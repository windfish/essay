## 海量数据问题处理思路

分布式存储、分布式并行计算

#### 需求

* 后台有100W个搜索日志文件，总大小约100T，求每天搜索中，热度最高的10个问题
解决方案：一个大问题拆分成多个小问题来解决，将100T 分为10000个小文件（分而治之），并行运行10000个任务，最终汇总

* 后台有100W个搜索日志文件，总大小约100T，求昨天和今天的共同会员
解决方案：对两天的数据都进行hash 散列，只需要将第一天的第一个分区和第二天的第一个分区求交集，其余类似

* 快速判断7天内的日志数据中，判断某个用户ID 是否存在

> 海量数据的计算解决方案：多个小任务并行执行运算，再执行第二个阶段的汇总


## 通信模型
* JDK 原生的BIO，阻塞式IO，无法支撑高并发
    * 客户端和服务线程是1：1的，服务器资源不够用
    * 有两处阻塞的方法实现：serverSocket.accept() 和 inputStream.readLine()
* JDK 原生的NIO，非阻塞式IO，可以支持高并发，但自己实现复杂
    * 通过selector 管理链接请求，用来调度应用程序的执行
* 基于NIO 的Netty 框架，封装好，API 易用
* JDK 1.7 之后提供的AIO，真正的异步编程模型


## RPC 的调用过程
```
1、client 调用本地动态代理proxy
2、这个代理会通过协议序列化字节流
3、通过netty 网络框架，将字节流发送到服务器
4、服务器收到这个字节流后，反序列化为原始的调用，利用反射原理调用服务方提供的方法
5、如果请求有返回值，把返回值根据协议序列化，再通过netty 返回给客户端
```



